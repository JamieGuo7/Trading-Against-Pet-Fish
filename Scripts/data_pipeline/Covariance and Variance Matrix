import numpy as np
import pandas as pd
import yfinance as yf
from test_variances import get_variances
from covariance import get_covariance_matrix

variances = get_variances()
covariance = get_covariance_matrix()

stocks = variances.index
n = len(stocks) 

Sigma = pd.DataFrame(
    np.zeros((n,n)), 
    index = stocks,
    columns = stocks
)

for stock in stocks:
    Sigma.loc[stock,stock] = variances[stock]

for i in stocks: 
    for j in stocks: 
        if i != j:
            Sigma.loc[i,j] = covariance.loc[i,j]


Sigma.to_excel("cov.xlsx")

